<!DOCTYPE html>
<html>
<head>
 <meta charset="utf-8" />
 <title>Mail::DMARC::Report::View::HTTP</title>
 <link rel="stylesheet" type="text/css" media="screen" href="http://code.jquery.com/ui/1.10.3/themes/cupertino/jquery-ui.css" />
 <link rel="stylesheet" type="text/css" media="screen" href="/dmarc/css/ui.jqgrid.css" />
 <script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script>
 <script type="text/javascript" src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
 <script type="text/javascript" src="/dmarc/js/i18n/grid.locale-en.js"></script>
 <script type="text/javascript" src="/dmarc/js/jquery.jqGrid.min.js"></script>

<style type="text/css">
html, body {
  margin: 0;
  padding: 0;
  font-size: 80%;
}
</style>

<script type="text/javascript">
// Set the options globally
jQuery.extend(jQuery.jgrid.defaults, {
		altRows:true,
    datatype: "json",
    height:'500',
    jsonReader : {
		  root:   'rows',
			page:   'cur_page',
			total:  'total_pages',
			records:'total_rows',
        repeatitems:false,
			subgrid: {
				root:   'rows',
				page:   'cur_page',
				total:  'total_pages',
				records:'total_rows',
				repeatitems:false,
			},
    },
    pager: '#gridpager',
  });
</script>

<script type="text/javascript">
jQuery(document).ready(function(){
  jQuery("#grid").jqGrid({
      url:'/dmarc/json/report',
      mtype: 'POST',
      colNames:['Id','Recipient','From','Org Name','Begin','End','UUID' ],
      colModel :[
        {name:'rid', index:'rid', width:30, align:'center', sortable: true },
        {name:'rcpt_domain', index:'rcpt_domain', width:135, align:'right', sortable: true},
        {name:'from_domain', index:'from_domain', width:135, align:'right', sortable: true},
        {name:'author',      index:'author',      width:170, align:'center' },
        {name:'begin',       index:'begin',       width:90, sorttype:'date'},
        {name:'end',         index:'end',         width:90, sorttype:'date',},
        {name:'uuid',        index:'uuid',        width:120, align:'left'},
// {name:'type',index:'type', width:200,editable:true,edittype:'select',editoptions:{dataUrl: '/jqGridOptionData?entity=WineType'}},
      ],
      rowNum: 100,
      rowList: [50,100,500],
      sortname: 'rid',
      viewrecords: true,
      editurl:"/dmarc/json/record/edit",
      sortorder: 'desc',
      caption:"DMARC Reports",
			subGrid: true,
		  subGridUrl:'/dmarc/json/row',
			subGridModel: [
				{
        name:['','IP','Count','Disposition','SPF','DKIM','Envelope To','Envelope From'],
				width:[70,200,15,40,40,40,100,100,100],
				align:[,'center','center','center','center','center','right','right'],
				params: ['rid'],
        mapping: [,'source_ip','count','disposition','spf','dkim','envelope_to','envelope_from'],
				},
			],
		  filterToolbar: {
				autosearch:true
			},
  })
	.navGrid('#gridpager',{add:false,del:false,edit:false,search:true});
});

jQuery("#mybutton").click(function() {
   jQuery("#grid").setColumns({'Begin':'begin','End':'end'});
   return false;
});
</script>

</head>

<body>
<p><a href="http://search.cpan.org/dist/Mail-DMARC/">Mail::DMARC::Report::View::HTTP</a> - sponsored by <a href="http://www.colocateusa.net/">ColocateUSA</a>.</p>

<div id="mybutton"></div>

<div id="jqgrid">
 <table id="grid"></table>
 <div id="gridpager"></div>
</div>

</body>
</html>
